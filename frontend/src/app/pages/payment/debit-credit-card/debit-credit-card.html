<section id="view-cards" class="mt-1 border rounded-3 px-4 pt-3" [formGroup]="cardForm">
    <h4>Pagar con Tarjeta</h4>
    <div class="form-group my-3">
        <label class="form-label" for="cardNumber">Numero de tarjeta</label>
        <div class="position-relative">
            <input class="form-control" type="number" id="cardNumber" name="cardNumber" placeholder="0000 0000 0000 0000" formControlName="cardNumber" 
                [ngClass]="{'is-invalid': cardForm.get('cardNumber')?.invalid && cardForm.get('cardNumber')?.touched}"
                required>   
            <span class="position-absolute top-50 end-0 translate-middle color-gray">
                <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 36 24"><path fill="currentColor" d="M0 21.5V12h36v9.5a2.507 2.507 0 0 1-2.5 2.5H2.466a2.4 2.4 0 0 1-1.731-.734l-.001-.001a2.401 2.401 0 0 1-.735-1.731v-.036v.002zM10 18v2h6v-2zm-6 0v2h4v-2zM33.5 0A2.507 2.507 0 0 1 36 2.5V6H0V2.466A2.4 2.4 0 0 1 .734.735L.735.734a2.401 2.401 0 0 1 1.731-.735h.036H2.5z"/></svg>
            </span>

            @if(cardForm.get('cardNumber')?.invalid && cardForm.get('cardNumber')?.touched){
                <div class="invalid-feedback d-block">Número de tarjeta inválido o requerido.</div>
            }
        </div>
        
    </div>

    <div class="d-flex w-100 justify-content-between my-3">
        <div class="form-group" style="width: 48%;">
            <label class="form-label" for="expiryDate">Fecha de Vencimiento</label>
            <input 
                class="form-control" 
                type="text" 
                id="expiryDate" 
                name="expiryDate" 
                placeholder="MM/AA" 
                formControlName="expiryDate" 
                [ngClass]="{'is-invalid': cardForm.get('expiryDate')?.invalid && cardForm.get('expiryDate')?.touched}"
                required>

                @if(cardForm.get('expiryDate')?.invalid && cardForm.get('expiryDate')?.touched){
                    <div class="invalid-feedback d-block">Formato MM/AA requerido.</div>
                }
        </div>

        <div class="form-group" style="width: 48%;">
            <label class="form-label" for="cvc">CVC</label>
            <input class="form-control" type="number" id="cvc" name="cvc" placeholder="Cod. de 3 o 4 digitos" [ngClass]="{'is-invalid': cardForm.get('cvc')?.invalid && cardForm.get('cvc')?.touched}" formControlName="cvc"
            required>

            @if(cardForm.get('cvc')?.invalid && cardForm.get('cvc')?.touched){
                <div class="invalid-feedback d-block">CVC inválido o requerido.</div>
            }

        </div>
    </div>

    <div class="form-group my-3">
        <label class="form-label" for="completeName">Nombre del titular</label>
        <input class="form-control" type="text" id="completeName" name="completeName" placeholder="Introduce el nombre impreso en la tarjeta" formControlName="cardHolderName" 
        [ngClass]="{'is-invalid': cardForm.get('cardHolderName')?.invalid && cardForm.get('cardHolderName')?.touched}"
        required>

        @if(cardForm.get('cardHolderName')?.invalid && cardForm.get('cardHolderName')?.touched){
            <div class="invalid-feedback d-block">El nombre del titular es obligatorio.</div>
        }

    </div>

    <section class="my-4">
        <h5 class="option-title mb-2 text-body-secondary">OPCIONES DE PAGO EN CUOTAS</h5>
        <div class="w-flex">
            @for(numero of arrayForLoop; track numero){
                <div class="input-group w-100 d-flex">
                    <div class="w-100 d-flex border p-2" [ngClass]="{'border-danger': cardForm.get('dues')?.invalid && cardForm.get('dues')?.touched && cardForm.get('dues')?.value !== numero}">
                        <input 
                            class="form-check-input mt-0 me-3" 
                            type="radio" 
                            name="dues" 
                            [value]="numero" 
                            formControlName="dues"
                            id="dues-{{ numero }}-select">

                        <label class="w-100 d-flex justify-content-between" for="dues-{{ numero }}-select">
                            <p class="dues-text">
                                @if(numero === 1){
                                    Pago de contado
                                } @else{
                                    {{ numero }} cuotas
                                }
                            </p>

                            <p class="dues-text">
                                1.339.618,00 / {{numero}} meses
                            </p>
                        </label>
                    </div>
                </div>
            }
            @if(cardForm.get('dues')?.invalid && cardForm.get('dues')?.touched){
                <div class="invalid-feedback d-block">Debes seleccionar el número de cuotas.</div>
            }

    </div>

</section>
